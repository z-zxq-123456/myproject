<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcits.orion.core.dao.AutoReversalDao">

    <sql id="fwReversalTran">REVERSAL_ID,REVERSAL_ARGS,TRAN_DATE,REVERSAL_DATE,MAX_REVERSAL_CNT,REVERSAL_CNT,REVERSAL_BEAN_ID,RET_CODE,RET_MSG,STATUS</sql>
    
    <insert id="insertReversal" parameterType="java.util.Map">
        insert into fw_reversal_tran
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="REVERSAL_ID != null">
                REVERSAL_ID,
            </if>
            <if test="REVERSAL_ARGS != null">
                REVERSAL_ARGS,
            </if>
            <if test="TRAN_DATE != null">
                TRAN_DATE,
            </if>
            <if test="REVERSAL_DATE != null">
                REVERSAL_DATE,
            </if>
            <if test="MAX_REVERSAL_CNT != null">
                MAX_REVERSAL_CNT,
            </if>
            <if test="REVERSAL_CNT != null">
                REVERSAL_CNT,
            </if>
            <if test="REVERSAL_BEAN_ID != null">
                REVERSAL_BEAN_ID,
            </if>
            <if test="RET_CODE != null">
                RET_CODE,
            </if>
            <if test="RET_MSG != null">
                RET_MSG,
            </if>
            <if test="STATUS != null">
                STATUS,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="REVERSAL_ID != null">
                #{REVERSAL_ID,jdbcType=VARCHAR},
            </if>
            <if test="REVERSAL_ARGS != null">
                #{REVERSAL_ARGS,jdbcType=LONGVARBINARY},
            </if>
            <if test="TRAN_DATE != null">
                #{TRAN_DATE,jdbcType=VARCHAR},
            </if>
            <if test="REVERSAL_DATE != null">
                #{REVERSAL_DATE,jdbcType=VARCHAR},
            </if>
            <if test="MAX_REVERSAL_CNT != null">
                #{MAX_REVERSAL_CNT,jdbcType=INTEGER},
            </if>
            <if test="REVERSAL_CNT != null">
                #{REVERSAL_CNT,jdbcType=INTEGER},
            </if>
            <if test="REVERSAL_BEAN_ID != null">
                #{REVERSAL_BEAN_ID,jdbcType=VARCHAR},
            </if>
            <if test="RET_CODE != null">
                #{RET_CODE,jdbcType=VARCHAR},
            </if>
            <if test="RET_MSG != null">
                #{RET_MSG,jdbcType=VARCHAR},
            </if>
            <if test="STATUS != null">
                #{STATUS,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateReversal" parameterType="java.util.Map">
        UPDATE fw_reversal_tran
        <set>
            <if test="REVERSAL_DATE != null">
                REVERSAL_DATE=#{REVERSAL_DATE},
            </if>
            <if test="REVERSAL_CNT != null">
                REVERSAL_CNT=#{REVERSAL_CNT},
            </if>
            <if test="RET_CODE != null">
                RET_CODE=#{RET_CODE},
            </if>
            <if test="RET_MSG != null">
                RET_MSG=#{RET_MSG},
            </if>
            <if test="STATUS != null">
                STATUS=#{STATUS},
            </if>
        </set>
        where REVERSAL_ID = #{REVERSAL_ID}
    </update>
    <select id="getReversals" parameterType="ParameterWrapper"
            resultType="java.util.Map">
        SELECT <include refid="fwReversalTran"/> from fw_reversal_tran where STATUS = 'N'
    </select>
</mapper>