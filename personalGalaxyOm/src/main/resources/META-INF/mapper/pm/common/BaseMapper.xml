<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcits.ensemble.om.pm.dao.utils.WebBaseDao">
    <delete id="deleteDataForSuccessPulishFlow" parameterType="java.util.HashMap">
        delete from ${tableName}
        where  COLUMN_STATUS = 'N'
    </delete>
    <delete id="deleteDataForCancel" parameterType="java.util.HashMap">
        delete from ${tableName}
        where  COLUMN_STATUS = 'W'
    </delete>
    <update id="updateDataForSuccessPublishFlow" parameterType="java.util.HashMap">
        update ${tableName}
        <set>
            COLUMN_STATUS = 'Y'
        </set>
        where COLUMN_STATUS = 'W'
    </update>
    <update id="updateDataForCancel" parameterType="java.util.HashMap">
        update ${tableName}
        <set>
            COLUMN_STATUS = 'Y'
        </set>
        where COLUMN_STATUS = 'N'
    </update>
    <select id="getTableUpdateTimes" parameterType="java.util.HashMap" resultType="java.lang.Integer">
        select count(*)
        from ${tableName}
        where COLUMN_STATUS != 'Y'
    </select>
    <select id="getDeleteDataByTableName" parameterType="java.util.HashMap" resultType="java.lang.Integer">
        select count(*)
        from ${tableName}
        where COLUMN_STATUS = 'N'
    </select>
    <select id="selectByPrimaryKeyForY" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select * from ${tableName}
        where    1=1
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} =#{${pks},jdbcType=VARCHAR}
        </foreach>
        AND  COLUMN_STATUS = 'Y'
    </select>
    <select id="selectDataByPKForW" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select * from ${tableName}
        where    1=1
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} =#{${pks},jdbcType=VARCHAR}
        </foreach>
        AND  COLUMN_STATUS = 'W'
    </select>
    <select id="selectDataByPrimaryKeyForN" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select * from ${tableName}
        where    1=1
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} =#{${pks},jdbcType=VARCHAR}
        </foreach>
        AND  COLUMN_STATUS = 'N'
    </select>
    <select id="selectByInsertStatusPK" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select * from ${tableName}
        where    1=1
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} =#{${pks},jdbcType=VARCHAR}
        </foreach>
        AND  COLUMN_STATUS = 'W'
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.util.HashMap">
        delete from ${tableName}
        where    1=1
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} =#{${pks},jdbcType=VARCHAR}
        </foreach>
        AND  COLUMN_STATUS = 'W'
    </delete>
    <update id="upDateParaDataStatus" parameterType="java.util.HashMap">
        update ${tableName}
        <set>
            COLUMN_STATUS =#{COLUMN_STATUS,jdbcType=VARCHAR}
        </set>
        where 1=1
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} = #{${pks},jdbcType=VARCHAR}
        </foreach>
    </update>
    <update id="updateForNewData" parameterType="java.util.HashMap">
        update ${tableName}
        <set>
            COLUMN_STATUS = 'N'
        </set>
        where 1=1
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} = #{${pks},jdbcType=VARCHAR}
        </foreach>
    </update>
    <update id="updateNotCheckData" parameterType="java.util.HashMap">
        update ${tableName}
        <set>
            <foreach item="col" index="index" collection="col"  >
                <if test="col != null">
                    ${col} = #{${col},jdbcType=VARCHAR},
                </if>
            </foreach>
        </set>
        where COLUMN_STATUS='W'
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} = #{${pks},jdbcType=VARCHAR}
        </foreach>
    </update>
    <insert id="insertForNewData" parameterType="java.util.HashMap">
        insert into ${tableName}
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <foreach item="col" index="index" collection="col"  >
                <if test="col != null">
                    ${col},
                </if>
            </foreach>
            <foreach item="pks" index="index" collection="pks"  >
                ${pks},
            </foreach>
            COLUMN_STATUS
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <foreach item="colV" index="index" collection="colV" >
            <if test="colV != null">
                <if test="colV != ''">
                    #{${colV},jdbcType=VARCHAR},
                </if>
                <if test="colV == ''">
                    #{'',jdbcType=VARCHAR},
                </if>
            </if>
            </foreach>
            <foreach item="pksV" index="index" collection="pksV" >
                #{${pksV},jdbcType=VARCHAR},
            </foreach>
            'W'
        </trim>
    </insert>
    <insert id="insertForNewDataOnlyKeyValue" parameterType="java.util.HashMap">
        insert into ${tableName}
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <foreach item="pks" index="index" collection="pks"  >
                ${pks},
            </foreach>
            COLUMN_STATUS
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <foreach item="pksV" index="index" collection="pksV" >
                #{${pksV},jdbcType=VARCHAR},
            </foreach>
            'W'
        </trim>
    </insert>
    <select id="selectByTableName" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select *
        from ${tableName}
        where COLUMN_STATUS!='N'
    </select>
    <select id="selectTableAndCol" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select *
        from ${tableName}
        where 1=1
        <if test="col1 != null">
            <if test="colV1 != null">
                AND  ${col1}=#{colV1,jdbcType=VARCHAR}</if>
        </if>
        <if test="col2 != null">
            <if test="colV2 != null">
                AND ${col2}=#{colV2,jdbcType=VARCHAR}</if>
        </if>
        <if test="col3 != null">
            <if test="colV3 != null">
                AND   ${col3}=#{colV3,jdbcType=VARCHAR}</if>
        </if>
        AND COLUMN_STATUS!='N'
    </select>
    <select id="selectParameterPklistWithCondition" parameterType="java.util.HashMap" resultType="com.dcits.dynamic.web.mapper.PkList">
        select
        <if test="_databaseId == 'oracle'">
            ${value} pk_value, ${value} || ' ' ||${valueDesc}  pk_desc
        </if>
        <if test="_databaseId == 'mysql'">
            ${value} pk_value,concat(${value},' ',${valueDesc} ) pk_desc
        </if>
        from ${tableName}
        where COLUMN_STATUS = 'Y'
        <foreach item="pks" index="index" collection="pks" >
            AND
            ${pks} = #{${pks},jdbcType=VARCHAR}
        </foreach>
    </select>
    <select id="selectParameterPklist" parameterType="java.util.HashMap" resultType="com.dcits.dynamic.web.mapper.PkList">
        select
        <if test="_databaseId == 'oracle'">
            ${value} pk_value, ${value} || ' ' ||${valueDesc}  pk_desc
        </if>
        <if test="_databaseId == 'mysql'">
            ${value} pk_value,concat(${value},' ',${valueDesc} ) pk_desc
        </if>
        from ${tableName}
        where COLUMN_STATUS = 'Y'
    </select>
    <select id="tableData" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select distinct  ${tableCol},${tableColDes}
        from   ${tableName}
    </select>
    <select id="selectStatusW" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select *
        from ${tableName}
        where COLUMN_STATUS='W'
    </select>
    <select id="selectStatusN" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select *
        from ${tableName}
        where COLUMN_STATUS='N'
    </select>
</mapper>