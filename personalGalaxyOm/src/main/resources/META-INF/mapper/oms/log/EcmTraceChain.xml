<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcits.ensemble.om.oms.dao.log.EcmTraceChainDao">


  <select id="findList" parameterType="com.dcits.ensemble.om.oms.module.log.EcmTraceChain" resultType="com.dcits.ensemble.om.oms.module.log.EcmTraceChain">
    select * from ECM_TCECHAIN_START left join ECM_TCECIN_BUS on ECM_TCECHAIN_START.TRACE_ID=ECM_TCECIN_BUS.TRACE_ID
    left join ECM_TCECIN_END on ECM_TCECHAIN_START.TRACE_ID=ECM_TCECIN_END.TRACE_ID
    <where>
    <if test="baseParam.startTime!=null ">
      <if test="baseParam.endTime!=null">
       <![CDATA[
      ECM_TCECHAIN_START.TRACE_STTIME >= #{baseParam.startTime,jdbcType=VARCHAR} and ECM_TCECHAIN_START.TRACE_STTIME<= #{baseParam.endTime,jdbcType=VARCHAR}
      ]]>
      </if>
    </if>
    <if test = "baseParam.branchId!=null">
       and ECM_TCECIN_BUS.BRANCH_ID =  #{baseParam.branchId ,jdbcType=VARCHAR}
    </if>
    <if test = "baseParam.tellerId!=null">
      and ECM_TCECIN_BUS.TELLER_ID = #{baseParam.tellerId ,jdbcType=VARCHAR }
    </if>

    </where>
    order by   ECM_TCECIN_END.TRACE_STATUS desc, ECM_TCECHAIN_START.TRACE_STTIME   desc
  </select>

  <select id="findChainList" parameterType="java.util.Map" resultType="com.dcits.ensemble.om.oms.module.log.EcmTraceChain">
    select *
    from ECM_TCECHAIN_START left join ECM_TCECIN_BUS on ECM_TCECHAIN_START.TRACE_ID=ECM_TCECIN_BUS.TRACE_ID
    left join ECM_TCECIN_END on ECM_TCECHAIN_START.TRACE_ID=ECM_TCECIN_END.TRACE_ID
    where ECM_TCECHAIN_START.TRACE_ID = #{traceId,jdbcType=VARCHAR}
  </select>


</mapper>