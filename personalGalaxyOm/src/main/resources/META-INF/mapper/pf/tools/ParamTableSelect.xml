<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcits.ensemble.om.pf.dao.tools.ParamTableSelectDao">
    <select id="selectByTableName" parameterType="java.lang.String" resultType="java.util.Map">
        select *
        from ${tableName}
    </select>
    <select id="selectTableAndCol" parameterType="Map" resultType="Map">
        select *
        from ${tableName}
        where 1=1
        <if test="col1 != null">
            <if test="colV1 != null">
       AND  ${col1}=#{colV1,jdbcType=VARCHAR}</if>

         </if>
        <if test="col2 != null">
            <if test="colV2 != null">
                AND ${col2}=#{colV2,jdbcType=VARCHAR}</if>

        </if>
        <if test="col3 != null">
            <if test="colV3 != null">
              AND   ${col3}=#{colV3,jdbcType=VARCHAR}</if>

        </if>
    </select>
    <select id="selectParameterPklist" parameterType="Map" resultType="com.dcits.ensemble.om.pf.module.PkList">
        select
        <if test="_databaseId == 'oracle'">
            ${value} pk_value, ${value} || ' ' ||${valueDesc}  pk_desc
        </if>
        <if test="_databaseId == 'mysql'">
            ${value} pk_value,concat(${value},' ',${valueDesc} ) pk_desc
        </if>
        from ${tableName}
    </select>
    <select id="tableData" parameterType="Map" resultType="Map">
        select distinct  ${tableCol},${tableColDes}
        from   ${tableName}
    </select>
    <select id="selectByData" parameterType="Map" resultType="java.util.Map">
        select *
        from DM_EXCEL_SELECT
        where TABLE_NAME=#{tableName,jdbcType=VARCHAR}
    </select>

</mapper>