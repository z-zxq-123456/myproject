<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dcits.galaxy.dal.demo.entities.Custom" >

	<insert id="insert" parameterType="Custom">
		INSERT INTO CUSTOM (CUSTOM_ID , CUSTOM_NAME , CUSTOM_TYPE , AGE, AMT)
		VALUES( #{customId} , #{customName} , #{customType} , #{age}, #{amt}) 
	</insert>
	
	<select id="findTotal" resultType="int" parameterType="Custom">
		SELECT COUNT(*) AS TOTAL FROM CUSTOM WHERE CUSTOM_TYPE = #{customType}
	</select>
	
	<select id="findConverge" resultType="hashmap" parameterType="Custom">
		SELECT MIN(AGE) AS MIN_AGE, MAX(AGE) AS MAX_AGE, SUM(AMT) AS AMT FROM CUSTOM
	</select>
	
	<select id="findOrderBy" resultType="hashmap" parameterType="Custom">
		SELECT * FROM CUSTOM ORDER BY CUSTOM_ID ASC, AGE DESC
	</select>
	
	<select id="findPage" resultType="hashmap" parameterType="ParameterWrapper">
		SELECT * FROM CUSTOM WHERE CUSTOM_ID<![CDATA[>]]>#{baseParam.customId} ORDER BY CUSTOM_ID
	</select>
	
	<select id="findPageTotal" resultType="int" parameterType="ParameterWrapper">
		SELECT count(*) AS TOTAL FROM CUSTOM WHERE CUSTOM_ID<![CDATA[>]]>#{baseParam.customId}
	</select>
	
	<select id="findPageOffset" resultType="int" parameterType="ParameterWrapper">
		SELECT COUNT(*) AS NUM FROM CUSTOM 
		WHERE 
			( customId<![CDATA[>]]>#{baseParam.customId} ) 
			AND 
			( ( customId<![CDATA[<]]>#{extParam.customId} ) OR ( customId<![CDATA[=]]>#{extParam.customId}) ) 
	</select>
</mapper>